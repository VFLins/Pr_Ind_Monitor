---
title: "Indicador de Preços das GPUs"
output: 
  flexdashboard::flex_dashboard:
    navbar:
      - {icon: "ion-social-github", href: "https://github.com/VFLins/Prind_Monitor"}
      - {title: "Sobre mim", href: "https://sites.google.com/view/vflins/"}
      - {title: "Me apoie", href: "https://www.paypal.com/donate/?hosted_button_id=LCT6TBWH4LN8S"}
    orientation: columns
    vertical_layout: fill
    css: "theme.css"
---

```{r setup, include=FALSE, message=FALSE}
source("functions.R")

library(plotly)
library(flexdashboard)
prices <- readRDS("data/prices.rds")
```

INÍCIO
=======================================================================

Column {data-width=550}
-----------------------------------------------------------------------

### Indicador dos preços

```{r}
# Add week data
prices["semana"] <- as.POSIXct(prices$Date, tz=Sys.timezone()) |> 
    cut.POSIXt(breaks="1 week", labels=F)

# Best price for every GPU per week
temp <- aggregate(
    prices$Price, list(prices$semana, prices$Date), FUN=min) |>
    setNames(c("Semana", "Chip", "Melhor preço"))

# Mean of best prices for each week
temp <- aggregate(temp$`Melhor preço`, list(temp$Semana), FUN=mean) |>
    setNames(c("Semana", "Índice"))

datas <- aggregate(prices$Date, list(prices$semana), FUN=max) |>
    setNames(c("Semana", "Dia"))

temp <- merge(temp, datas, by="Semana")

# Plot index
p <- ggplot(temp, aes(x=Dia, y=Índice)) + 
    geom_line(linewidth=1.2, color=cores["main"]) + 
    geom_point(size=4, color=cores["main"]) +
    labs(x=NULL, y=NULL) +
    plot_theme()
bslib::layout_columns(ggplotly(p))
```

PREÇO E PERFORMACE
=======================================================================

Row {data-height=550}
-----------------------------------------------------------------------

### Melhores preços

```{r}

```

Row {data-height=450}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```

